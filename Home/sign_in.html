<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>AppLearn â€“ Log In</title>
  <link rel="stylesheet" href="sign_in.css" />
  <script defer src="./site.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<header class="header" id="navbar">
  <nav class="navbar navbar-expand-sm navbar-light border-bottom box-shadow mb-3">
    <div class="container-fluid">
      <a class="navbar-brand" href="Home.html">
        <img src="./img/App-Learn Wordmark V1.png" alt="AppLearn" style="height:80px;width:250px;">
      </a>
      <div class="navbar-collapse collapse d-sm-flex justify-content-center">
        <ul class="navbar-nav">
          <li class="nav-item"><a class="nav-link" style="color:white;" href="Home.html">Home</a></li>
          <li class="nav-item"><a class="nav-link" style="color:white;" href="Explore.html">Explore</a></li>
          <li class="nav-item"><a class="nav-link" style="color:white;" href="AboutUs.html">About Us</a></li>
          <li class="nav-item"><a class="nav-link" style="color:white;" href="Dashboardchoice.html">Dashboard</a></li>
        </ul>
      </div>
      <div class="button-container">
        <a id="loginNavBtn"  class="btn btn-dark btn-lg" href="sign_in.html">Login</a>
        <a id="signupNavBtn" class="btn btn-dark btn-lg" href="StudentorTeacher.html">Sign-Up</a>
        
      </div>
    </div>
  </nav>
</header>

<main class="container" style="max-width:480px; padding-top:120px; padding-bottom:60px;">
  <h1 class="mb-4 text-center">Log in</h1>
  <div id="loginAlert" class="alert alert-danger d-none"></div>

  <form id="loginForm" class="card p-4 shadow-sm">
    <div class="mb-3">
      <label class="form-label">Email</label>
      <input id="email" type="email" class="form-control" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Password</label>
      <input id="password" type="password" class="form-control" required>
    </div>
    <button class="btn btn-dark btn-lg w-100" type="submit">Log In</button>
    <p class="mt-3 mb-0 text-center">No account? <a href="StudentorTeacher.html">Create one</a></p>
  </form>
</main>

<script>
document.getElementById('loginForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  const email = document.getElementById('email').value.trim();
  const password = document.getElementById('password').value;
  const alertBox = document.getElementById('loginAlert');
  const showErr = (msg) => { alertBox.textContent = msg; alertBox.classList.remove('d-none'); };
  alertBox.classList.add('d-none');

  try {
    const res = await fetch('/api/login', {
      method: 'POST', headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, password })
    });
    const data = await res.json();
    if (!res.ok || !data.ok) throw new Error(data.error || 'Login failed');
    // Redirect to dashboard choice (change if you prefer)
    window.location.href = 'Dashboardchoice.html';
  } catch (err) {
    showErr(err.message);
  }
});
</script>
</body>
</html>
